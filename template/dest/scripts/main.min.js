function init(){var t=new ymaps.Map("map",{center:[55.76,37.64],zoom:11},{searchControlProvider:"yandex#search"});t.behaviors.disable("scrollZoom"),t.behaviors.disable("MultiTouch"),jQuery.getJSON("data.json",function(e){function a(){var e,i=new ymaps.GeoQueryResult;"fair-weekend"==$("#map-but1").attr("value")&&(i=n.search('properties.name == "yar1"')),"fair-region"==$("#map-but2").attr("value")&&(i=n.search('properties.name == "yar2"')),"food-markets"==$("#map-but3").attr("value")&&(i=n.search('properties.name == "yar3"')),"festivals"==$("#map-but4").attr("value")&&(i=n.search('properties.name == "yar4"')),"special-offer"==$("#map-but5").attr("value")&&(i=n.search('properties.name == "yar5"')),"fair-weekend"==$("#map-mini-but1").attr("value")&&(i=n.search('properties.name == "yar1"')),"fair-region"==$("#map-mini-but2").attr("value")&&(i=n.search('properties.name == "yar2"')),"food-markets"==$("#map-mini-but3").attr("value")&&(i=n.search('properties.name == "yar3"')),"festivals"==$("#map-mini-but4").attr("value")&&(i=n.search('properties.name == "yar4"')),"special-offer"==$("#map-mini-but5").attr("value")&&(i=n.search('properties.name == "yar5"')),"fair-weekend"==$("#dummy-map-but1").attr("value")&&(i=n.search('properties.name == "yar1"')),"fair-region"==$("#dummy-map-but2").attr("value")&&(i=n.search('properties.name == "yar2"')),"food-markets"==$("#dummy-map-but3").attr("value")&&(i=n.search('properties.name == "yar3"')),"festivals"==$("#dummy-map-but4").attr("value")&&(i=n.search('properties.name == "yar4"')),"special-offer"==$("#dummy-map-but5").attr("value")&&(i=n.search('properties.name == "yar5"')),e=i.addToMap(t),n.remove(i).removeFromMap(t)}var n=ymaps.geoQuery(e);for(i=0;i<n._objects.length;i++)n._objects[i].options.set({iconLayout:"default#image",iconImageHref:"images/map-marker.png",iconImageSize:[49,40],iconImageOffset:[-20,-20]}),n._objects[i].events.add("click",function(){$("#mapModal").modal("show")});n.addToMap(t),$(document).ready(function(){$("#map-but1").click(function(){$("#map-but1").attr("value","fair-weekend"),"fair-weekend"==$("#map-but1").attr("value")&&(a(),$("#map-but1").removeAttr("value"))}),$("#map-but2").click(function(){$("#map-but2").attr("value","fair-region"),"fair-region"==$("#map-but2").attr("value")&&(a(),$("#map-but2").removeAttr("value"))}),$("#map-but3").click(function(){$("#map-but3").attr("value","food-markets"),"food-markets"==$("#map-but3").attr("value")&&(a(),$("#map-but3").removeAttr("value"))}),$("#map-but4").click(function(){$("#map-but4").attr("value","festivals"),"festivals"==$("#map-but4").attr("value")&&(a(),$("#map-but4").removeAttr("value"))}),$("#map-but5").click(function(){$("#map-but5").attr("value","special-offer"),"special-offer"==$("#map-but5").attr("value")&&(a(),$("#map-but5").removeAttr("value"))}),$("#map-mini-but1").click(function(){$("#map-mini-but1").attr("value","fair-weekend"),"fair-weekend"==$("#map-mini-but1").attr("value")&&(a(),$("#map-mini-but1").removeAttr("value"))}),$("#map-mini-but2").click(function(){$("#map-mini-but2").attr("value","fair-region"),"fair-region"==$("#map-mini-but2").attr("value")&&(a(),$("#map-mini-but2").removeAttr("value"))}),$("#map-mini-but3").click(function(){$("#map-mini-but3").attr("value","food-markets"),"food-markets"==$("#map-mini-but3").attr("value")&&(a(),$("#map-mini-but3").removeAttr("value"))}),$("#map-mini-but4").click(function(){$("#map-mini-but4").attr("value","festivals"),"festivals"==$("#map-mini-but4").attr("value")&&(a(),$("#map-mini-but4").removeAttr("value"))}),$("#map-mini-but5").click(function(){$("#map-mini-but5").attr("value","special-offer"),"special-offer"==$("#map-mini-but5").attr("value")&&(a(),$("#map-mini-but5").removeAttr("value"))}),$("#dummy-map-but1").click(function(){$("#dummy-map-but1").attr("value","fair-weekend"),"fair-weekend"==$("#dummy-map-but1").attr("value")&&(a(),$("#dummy-map-but1").removeAttr("value"))}),$("#dummy-map-but2").click(function(){$("#dummy-map-but2").attr("value","fair-region"),"fair-region"==$("#dummy-map-but2").attr("value")&&(a(),$("#dummy-map-but2").removeAttr("value"))}),$("#dummy-map-but3").click(function(){$("#dummy-map-but3").attr("value","food-markets"),"food-markets"==$("#dummy-map-but3").attr("value")&&(a(),$("#dummy-map-but3").removeAttr("value"))}),$("#dummy-map-but4").click(function(){$("#dummy-map-but4").attr("value","festivals"),"festivals"==$("#dummy-map-but4").attr("value")&&(a(),$("#dummy-map-but4").removeAttr("value"))}),$("#dummy-map-but5").click(function(){$("#dummy-map-but5").attr("value","special-offer"),"special-offer"==$("#dummy-map-but5").attr("value")&&(a(),$("#dummy-map-but5").removeAttr("value"))})})})}function Segment(t,e,i){this.path=t,this.length=t.getTotalLength(),this.path.style.strokeDashoffset=2*this.length,this.begin=e?this.valueOf(e):0,this.end=i?this.valueOf(i):this.length,this.timer=null,this.draw(this.begin,this.end)}ymaps.ready(init),function(t,e,i,a){function n(e,i){var r=this;"object"==typeof i&&(delete i.refresh,delete i.render,t.extend(this,i)),this.$element=t(e),!this.imageSrc&&this.$element.is("img")&&(this.imageSrc=this.$element.attr("src"));var o=(this.position+"").toLowerCase().match(/\S+/g)||[];return o.length<1&&o.push("center"),1==o.length&&o.push(o[0]),("top"==o[0]||"bottom"==o[0]||"left"==o[1]||"right"==o[1])&&(o=[o[1],o[0]]),this.positionX!=a&&(o[0]=this.positionX.toLowerCase()),this.positionY!=a&&(o[1]=this.positionY.toLowerCase()),r.positionX=o[0],r.positionY=o[1],"left"!=this.positionX&&"right"!=this.positionX&&(isNaN(parseInt(this.positionX))?this.positionX="center":this.positionX=parseInt(this.positionX)),"top"!=this.positionY&&"bottom"!=this.positionY&&(isNaN(parseInt(this.positionY))?this.positionY="center":this.positionY=parseInt(this.positionY)),this.position=this.positionX+(isNaN(this.positionX)?"":"px")+" "+this.positionY+(isNaN(this.positionY)?"":"px"),navigator.userAgent.match(/(iPod|iPhone|iPad)/)?(this.iosFix&&!this.$element.is("img")&&this.$element.css({backgroundImage:"url("+this.imageSrc+")",backgroundSize:"cover",backgroundPosition:this.position}),this):navigator.userAgent.match(/(Android)/)?(this.androidFix&&!this.$element.is("img")&&this.$element.css({backgroundImage:"url("+this.imageSrc+")",backgroundSize:"cover",backgroundPosition:this.position}),this):(this.$mirror=t("<div />").prependTo("body"),this.$slider=t("<img />").prependTo(this.$mirror),this.$mirror.addClass("parallax-mirror").css({visibility:"hidden",zIndex:this.zIndex,position:"fixed",top:0,left:0,overflow:"hidden"}),this.$slider.addClass("parallax-slider").one("load",function(){r.naturalHeight&&r.naturalWidth||(r.naturalHeight=this.naturalHeight||this.height||1,r.naturalWidth=this.naturalWidth||this.width||1),r.aspectRatio=r.naturalWidth/r.naturalHeight,n.isSetup||n.setup(),n.sliders.push(r),n.isFresh=!1,n.requestRender()}),this.$slider[0].src=this.imageSrc,void((this.naturalHeight&&this.naturalWidth||this.$slider[0].complete)&&this.$slider.trigger("load")))}function r(a){return this.each(function(){var r=t(this),o="object"==typeof a&&a;this==e||this==i||r.is("body")?n.configure(o):r.data("px.parallax")||(o=t.extend({},r.data(),o),r.data("px.parallax",new n(this,o))),"string"==typeof a&&n[a]()})}!function(){for(var t=0,i=["ms","moz","webkit","o"],a=0;a<i.length&&!e.requestAnimationFrame;++a)e.requestAnimationFrame=e[i[a]+"RequestAnimationFrame"],e.cancelAnimationFrame=e[i[a]+"CancelAnimationFrame"]||e[i[a]+"CancelRequestAnimationFrame"];e.requestAnimationFrame||(e.requestAnimationFrame=function(i){var a=(new Date).getTime(),n=Math.max(0,16-(a-t)),r=e.setTimeout(function(){i(a+n)},n);return t=a+n,r}),e.cancelAnimationFrame||(e.cancelAnimationFrame=function(t){clearTimeout(t)})}(),t.extend(n.prototype,{speed:.2,bleed:0,zIndex:-100,iosFix:!0,androidFix:!0,position:"center",overScrollFix:!1,refresh:function(){this.boxWidth=this.$element.outerWidth(),this.boxHeight=this.$element.outerHeight()+2*this.bleed,this.boxOffsetTop=this.$element.offset().top-this.bleed,this.boxOffsetLeft=this.$element.offset().left,this.boxOffsetBottom=this.boxOffsetTop+this.boxHeight;var t=n.winHeight,e=n.docHeight,i=Math.min(this.boxOffsetTop,e-t),a=Math.max(this.boxOffsetTop+this.boxHeight-t,0),r=this.boxHeight+(i-a)*(1-this.speed)|0,o=(this.boxOffsetTop-i)*(1-this.speed)|0;if(r*this.aspectRatio>=this.boxWidth){this.imageWidth=r*this.aspectRatio|0,this.imageHeight=r,this.offsetBaseTop=o;var s=this.imageWidth-this.boxWidth;"left"==this.positionX?this.offsetLeft=0:"right"==this.positionX?this.offsetLeft=-s:isNaN(this.positionX)?this.offsetLeft=-s/2|0:this.offsetLeft=Math.max(this.positionX,-s)}else{this.imageWidth=this.boxWidth,this.imageHeight=this.boxWidth/this.aspectRatio|0,this.offsetLeft=0;var s=this.imageHeight-r;"top"==this.positionY?this.offsetBaseTop=o:"bottom"==this.positionY?this.offsetBaseTop=o-s:isNaN(this.positionY)?this.offsetBaseTop=o-s/2|0:this.offsetBaseTop=o+Math.max(this.positionY,-s)}},render:function(){var t=n.scrollTop,e=n.scrollLeft,i=this.overScrollFix?n.overScroll:0,a=t+n.winHeight;this.boxOffsetBottom>t&&this.boxOffsetTop<a?this.visibility="visible":this.visibility="hidden",this.mirrorTop=this.boxOffsetTop-t,this.mirrorLeft=this.boxOffsetLeft-e,this.offsetTop=this.offsetBaseTop-this.mirrorTop*(1-this.speed),this.$mirror.css({transform:"translate3d(0px, 0px, 0px)",visibility:this.visibility,top:this.mirrorTop-i,left:this.mirrorLeft,height:this.boxHeight,width:this.boxWidth}),this.$slider.css({transform:"translate3d(0px, 0px, 0px)",position:"absolute",top:this.offsetTop,left:this.offsetLeft,height:this.imageHeight,width:this.imageWidth,maxWidth:"none"})}}),t.extend(n,{scrollTop:0,scrollLeft:0,winHeight:0,winWidth:0,docHeight:1<<30,docWidth:1<<30,sliders:[],isReady:!1,isFresh:!1,isBusy:!1,setup:function(){if(!this.isReady){var a=t(i),r=t(e);r.on("scroll.px.parallax load.px.parallax",function(){var t=n.docHeight-n.winHeight,e=n.docWidth-n.winWidth;n.scrollTop=Math.max(0,Math.min(t,r.scrollTop())),n.scrollLeft=Math.max(0,Math.min(e,r.scrollLeft())),n.overScroll=Math.max(r.scrollTop()-t,Math.min(r.scrollTop(),0)),n.requestRender()}).on("resize.px.parallax load.px.parallax",function(){n.winHeight=r.height(),n.winWidth=r.width(),n.docHeight=a.height(),n.docWidth=a.width(),n.isFresh=!1,n.requestRender()}),this.isReady=!0}},configure:function(e){"object"==typeof e&&(delete e.refresh,delete e.render,t.extend(this.prototype,e))},refresh:function(){t.each(this.sliders,function(){this.refresh()}),this.isFresh=!0},render:function(){this.isFresh||this.refresh(),t.each(this.sliders,function(){this.render()})},requestRender:function(){var t=this;this.isBusy||(this.isBusy=!0,e.requestAnimationFrame(function(){t.render(),t.isBusy=!1}))}});var o=t.fn.parallax;t.fn.parallax=r,t.fn.parallax.Constructor=n,t.fn.parallax.noConflict=function(){return t.fn.parallax=o,this},t(i).on("ready.px.parallax.data-api",function(){t('[data-parallax="scroll"]').parallax()})}(jQuery,window,document),!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.ease={})}(this,function(t){"use strict";function e(t,e){return null==t||isNaN(t)?e:+t}function i(t,i){t=Math.max(1,e(t,1)),i=e(i,.3)*H;var a=i*Math.asin(1/t);return function(e){return t*Math.pow(2,10*--e)*Math.sin((a-e)/i)}}function a(t,i){t=Math.max(1,e(t,1)),i=e(i,.3)*H;var a=i*Math.asin(1/t);return function(e){return t*Math.pow(2,-10*e)*Math.sin((e-a)/i)+1}}function n(t,i){t=Math.max(1,e(t,1)),i=1.5*e(i,.3)*H;var a=i*Math.asin(1/t);return function(e){return t*((e=2*e-1)<0?Math.pow(2,10*e)*Math.sin((a-e)/i):Math.pow(2,-10*e)*Math.sin((e-a)/i)+2)/2}}function r(t){return t=e(t,1.70158),function(e){return e*e*((t+1)*e-t)}}function o(t){return t=e(t,1.70158),function(e){return--e*e*((t+1)*e+t)+1}}function s(t){return t=1.525*e(t,1.70158),function(e){return((e*=2)<1?e*e*((t+1)*e-t):(e-=2)*e*((t+1)*e+t)+2)/2}}function u(t){return 1-m(1-t)}function m(t){return S>t?P*t*t:N>t?P*(t-=W)*t+L:X>t?P*(t-=q)*t+Y:P*(t-=R)*t+E}function h(t){return((t*=2)<=1?1-m(1-t):m(t-1)+1)/2}function l(t){return 1-Math.sqrt(1-t*t)}function c(t){return Math.sqrt(1- --t*t)}function p(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}function f(t){return Math.pow(2,10*t-10)}function d(t){return 1-Math.pow(2,-10*t)}function b(t){return((t*=2)<=1?Math.pow(2,10*t-10):2-Math.pow(2,10-10*t))/2}function g(t){return 1-Math.cos(t*C)}function v(t){return Math.sin(t*C)}function y(t){return(1-Math.cos(j*t))/2}function $(t){return t*t*t}function x(t){return--t*t*t+1}function w(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}function k(t){return t*t}function M(t){return t*(2-t)}function T(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function A(t){return+t}function F(t){return t=e(t,3),function(e){return Math.pow(e,t)}}function O(t){return t=e(t,3),function(e){return 1-Math.pow(1-e,t)}}function I(t){return t=e(t,3),function(e){return((e*=2)<=1?Math.pow(e,t):2-Math.pow(2-e,t))/2}}function B(t,e,i){var a=(t+="").indexOf("-");return 0>a&&(t+="-in"),arguments.length>1&&D.hasOwnProperty(t)?D[t](e,i):z.hasOwnProperty(t)?z[t]:A}var H=1/(2*Math.PI),S=4/11,W=6/11,N=8/11,L=.75,q=9/11,X=10/11,Y=.9375,R=21/22,E=63/64,P=1/S/S,j=Math.PI,C=j/2,z={"linear-in":A,"linear-out":A,"linear-in-out":A,"quad-in":k,"quad-out":M,"quad-in-out":T,"cubic-in":$,"cubic-out":x,"cubic-in-out":w,"poly-in":$,"poly-out":x,"poly-in-out":w,"sin-in":g,"sin-out":v,"sin-in-out":y,"exp-in":f,"exp-out":d,"exp-in-out":b,"circle-in":l,"circle-out":c,"circle-in-out":p,"bounce-in":u,"bounce-out":m,"bounce-in-out":h,"back-in":r(),"back-out":o(),"back-in-out":s(),"elastic-in":i(),"elastic-out":a(),"elastic-in-out":n()},D={"poly-in":F,"poly-out":O,"poly-in-out":I,"back-in":r,"back-out":o,"back-in-out":s,"elastic-in":i,"elastic-out":a,"elastic-in-out":n};t.ease=B}),Segment.prototype={draw:function(t,e,i,a){if(i){var n=a.hasOwnProperty("delay")?1e3*parseFloat(a.delay):0,r=a.hasOwnProperty("easing")?a.easing:null,o=a.hasOwnProperty("callback")?a.callback:null,s=this;if(this.stop(),n)return delete a.delay,this.timer=setTimeout(function(){s.draw(t,e,i,a)},n),this.timer;var u=new Date,m=1e3/60,h=this.begin,l=this.end,c=this.valueOf(t),p=this.valueOf(e);!function f(){var t=new Date,e=(t-u)/1e3,a=e/parseFloat(i),n=a;return"function"==typeof r&&(n=r(n)),a>1?(s.stop(),n=1):s.timer=setTimeout(f,m),s.begin=h+(c-h)*n,s.end=l+(p-l)*n,s.begin<0&&(s.begin=0),s.end>s.length&&(s.end=s.length),s.begin<s.end?s.draw(s.begin,s.end):s.draw(s.begin+(s.end-s.begin),s.end-(s.end-s.begin)),a>1&&"function"==typeof o?o.call(s.context):void 0}()}else this.path.style.strokeDasharray=this.strokeDasharray(t,e)},strokeDasharray:function(t,e){return this.begin=this.valueOf(t),this.end=this.valueOf(e),[this.length,this.length+this.begin,this.end-this.begin].join(" ")},valueOf:function(t){var e=parseFloat(t);if(("string"==typeof t||t instanceof String)&&~t.indexOf("%")){var i;~t.indexOf("+")?(i=t.split("+"),e=this.percent(i[0])+parseFloat(i[1])):~t.indexOf("-")?(i=t.split("-"),e=this.percent(i[0])-parseFloat(i[1])):e=this.percent(t)}return e},stop:function(){clearTimeout(this.timer),this.timer=null},percent:function(t){return parseFloat(t)/100*this.length}},function(){function t(t){t.draw("80% - 240","80%",.3,{delay:.1,callback:function(){e(t)}})}function e(t){t.draw("100% - 545","100% - 305",.6,{easing:ease.ease("elastic-out",1,.3)})}function i(t){t.draw(f-60,d+60,.1,{callback:function(){a(t)}})}function a(t){t.draw(f+120,d-120,.3,{easing:ease.ease("bounce-out",1,.3)})}function n(t){t.draw("90% - 240","90%",.1,{easing:ease.ease("elastic-in",1,.3),callback:function(){r(t)}})}function r(t){t.draw("20% - 240","20%",.3,{callback:function(){o(t)}})}function o(t){t.draw(c,p,.7,{easing:ease.ease("elastic-out",1,.3)})}function s(t){t.draw(f,d,.7,{delay:.1,easing:ease.ease("elastic-out",2,.4)})}function u(){M?(t(y),i(x),t(w),T.className="dummy dummy--active"):(n(y),s(x),n(w),T.className="dummy"),M=!M}function m(t){t.className="menu-icon-wrapper scaled"}function h(t){t.className="menu-icon-wrapper"}function l(){m(W),L?(t(B),i(H),t(S),$(".menu-dummy").css("height","100%"),$("#dummy2").css("height","100%"),q.className="dummy dummy--active"):(n(B),s(H),n(S),q.className="dummy",$(".menu-dummy").delay(300).css("height","60px"),$("#dummy2").css("height","10px")),L=!L,setTimeout(function(){h(W)},450)}var c=80,p=320,f=80,d=320,b=document.getElementById("pathA"),g=document.getElementById("pathB"),v=document.getElementById("pathC"),y=new Segment(b,c,p),x=new Segment(g,f,d),w=new Segment(v,c,p),k=document.getElementById("menu-icon-trigger"),M=!0,T=document.getElementById("dummy"),A=document.getElementById("menu-icon-wrapper");A.style.visibility="visible",k.onclick=u,$(".dummy_map_item").click(u);var F=document.getElementById("pathD"),O=document.getElementById("pathE"),I=document.getElementById("pathF"),B=new Segment(F,c,p),H=new Segment(O,f,d),S=new Segment(I,c,p),W=document.getElementById("menu-icon-wrapper2"),N=document.getElementById("menu-icon-trigger2"),L=!0,q=document.getElementById("dummy2");W.style.visibility="visible",N.onclick=l,$(".dummy_menu_item").click(l)}();